schema: '2.0'
stages:
  method_output@4dvarnet:
    cmd: wget 
      https://s3.eu-west-2.wasabisys.com/oceanbench-data-registry/dvc/a5/2381e9409cb7c6cf9be980bda9aced
      -nc -O 'data/method_outputs/4dvarnet.nc'
    outs:
    - path: data/method_outputs/4dvarnet.nc
      hash: md5
      md5: a52381e9409cb7c6cf9be980bda9aced
      size: 590300748
  method_output@miost:
    cmd: wget 
      https://s3.eu-west-2.wasabisys.com/oceanbench-data-registry/dvc/4f/014481eed0088eb9a0cf329ebf045b
      -nc -O 'data/method_outputs/miost.nc'
    outs:
    - path: data/method_outputs/miost.nc
      hash: md5
      md5: 4f014481eed0088eb9a0cf329ebf045b
      size: 29804673
  method_output@bfn:
    cmd: wget 
      https://s3.eu-west-2.wasabisys.com/oceanbench-data-registry/dvc/29/6781b126d905e98b82dac9bcecf57e
      -nc -O 'data/method_outputs/bfn.nc'
    outs:
    - path: data/method_outputs/bfn.nc
      hash: md5
      md5: 296781b126d905e98b82dac9bcecf57e
      size: 700845764
  method_output@duacs:
    cmd: wget 
      https://s3.eu-west-2.wasabisys.com/oceanbench-data-registry/dvc/95/7d74696fbf5f2b6d0c528757951b8a
      -nc -O 'data/method_outputs/duacs.nc'
    outs:
    - path: data/method_outputs/duacs.nc
      hash: md5
      md5: 957d74696fbf5f2b6d0c528757951b8a
      size: 4684262
  method_output@dymost:
    cmd: wget 
      https://s3.eu-west-2.wasabisys.com/oceanbench-data-registry/dvc/1f/6fc60bba2ef471ff845b4cdcc18f6a
      -nc -O 'data/method_outputs/dymost.nc'
    outs:
    - path: data/method_outputs/dymost.nc
      hash: md5
      md5: 1f6fc60bba2ef471ff845b4cdcc18f6a
      size: 2354338
  fetch_reference_data:
    cmd: qf_alongtrack_lambdax_from_map -cd . -cn stage_configs 'to_run=[dl_tracks]'
    params:
      datachallenge.toml:
        pipelines.diagnostic.qf_alongtrack_lambdax_from_map: 0.0.1
      stage_configs.yaml:
        stages.dl_tracks:
          _target_: dz_download_ssh_tracks.run
          _partial_: true
          sat: c2
          download_dir: data/downloads/${.sat}
          min_time: '2017-01-01'
          max_time: '2017-12-31'
          filters:
          - '*2017*'
          _skip_val: false
    outs:
    - path: data/downloads/c2
      hash: md5
      md5: 8e65579c4dc11a00e6d3dde2c686105c.dir
      size: 165073748
      nfiles: 362
  filter_and_merge_ref:
    cmd: qf_alongtrack_lambdax_from_map -cd . -cn stage_configs 'to_run=[filter_and_merge]'
    params:
      datachallenge.toml:
        pipelines.diagnostic.qf_alongtrack_lambdax_from_map: 0.0.1
      stage_configs.yaml:
        stages.filter_and_merge:
          _target_: qf_filter_merge_daily_ssh_tracks.run
          _partial_: true
          input_dir: ${..dl_tracks.download_dir}
          output_path: data/prepared/${..dl_tracks.sat}.nc
          min_lon: -65.0
          max_lon: -55.0
          min_lat: 33.0
          max_lat: 43.0
          min_time: '2017-01-01'
          max_time: '2018-01-01'
          _skip_val: false
    outs:
    - path: data/prepared/c2.nc
      hash: md5
      md5: fb8bf253e87be431b298b136dde80d99
      size: 1397837
  interp_on_track@4dvarnet:
    cmd: qf_alongtrack_lambdax_from_map -cd . -cn stage_configs 'to_run=[interp_on_track]'
      'stages.interp_on_track.grid_var=rec_ssh' 'stages.method=4dvarnet'
    deps:
    - path: data/method_outputs/4dvarnet.nc
      hash: md5
      md5: a52381e9409cb7c6cf9be980bda9aced
      size: 590300748
    - path: data/prepared/c2.nc
      hash: md5
      md5: fb8bf253e87be431b298b136dde80d99
      size: 1397837
    params:
      datachallenge.toml:
        pipelines.diagnostic.qf_alongtrack_lambdax_from_map: 0.0.1
      stage_configs.yaml:
        stages.interp_on_track:
          _target_: qf_interp_grid_on_track.run
          _partial_: true
          track_path: ${..filter_and_merge.output_path}
          grid_path: data/method_outputs/${..method}.nc
          grid_var: ???
          output_path: data/method_outputs/${..method}_on_track.nc
          _skip_val: false
    outs:
    - path: data/method_outputs/4dvarnet_on_track.nc
      hash: md5
      md5: a86f49eeb091b177ec0e48aa801c21a2
      size: 1587241
  interp_on_track@miost:
    cmd: qf_alongtrack_lambdax_from_map -cd . -cn stage_configs 'to_run=[interp_on_track]'
      'stages.interp_on_track.grid_var=ssh' 'stages.method=miost'
    deps:
    - path: data/method_outputs/miost.nc
      hash: md5
      md5: 4f014481eed0088eb9a0cf329ebf045b
      size: 29804673
    - path: data/prepared/c2.nc
      hash: md5
      md5: fb8bf253e87be431b298b136dde80d99
      size: 1397837
    params:
      datachallenge.toml:
        pipelines.diagnostic.qf_alongtrack_lambdax_from_map: 0.0.1
      stage_configs.yaml:
        stages.interp_on_track:
          _target_: qf_interp_grid_on_track.run
          _partial_: true
          track_path: ${..filter_and_merge.output_path}
          grid_path: data/method_outputs/${..method}.nc
          grid_var: ???
          output_path: data/method_outputs/${..method}_on_track.nc
          _skip_val: false
    outs:
    - path: data/method_outputs/miost_on_track.nc
      hash: md5
      md5: f5e9d3d586f044def64eff61c6e92198
      size: 1587360
  interp_on_track@bfn:
    cmd: qf_alongtrack_lambdax_from_map -cd . -cn stage_configs 'to_run=[interp_on_track]'
      'stages.interp_on_track.grid_var=ssh' 'stages.method=bfn'
    deps:
    - path: data/method_outputs/bfn.nc
      hash: md5
      md5: 296781b126d905e98b82dac9bcecf57e
      size: 700845764
    - path: data/prepared/c2.nc
      hash: md5
      md5: fb8bf253e87be431b298b136dde80d99
      size: 1397837
    params:
      datachallenge.toml:
        pipelines.diagnostic.qf_alongtrack_lambdax_from_map: 0.0.1
      stage_configs.yaml:
        stages.interp_on_track:
          _target_: qf_interp_grid_on_track.run
          _partial_: true
          track_path: ${..filter_and_merge.output_path}
          grid_path: data/method_outputs/${..method}.nc
          grid_var: ???
          output_path: data/method_outputs/${..method}_on_track.nc
          _skip_val: false
    outs:
    - path: data/method_outputs/bfn_on_track.nc
      hash: md5
      md5: 3d31f6fed2f9786b7f69d0a8784abaec
      size: 1587360
  interp_on_track@duacs:
    cmd: qf_alongtrack_lambdax_from_map -cd . -cn stage_configs 'to_run=[interp_on_track]'
      'stages.interp_on_track.grid_var=ssh' 'stages.method=duacs'
    deps:
    - path: data/method_outputs/duacs.nc
      hash: md5
      md5: 957d74696fbf5f2b6d0c528757951b8a
      size: 4684262
    - path: data/prepared/c2.nc
      hash: md5
      md5: fb8bf253e87be431b298b136dde80d99
      size: 1397837
    params:
      datachallenge.toml:
        pipelines.diagnostic.qf_alongtrack_lambdax_from_map: 0.0.1
      stage_configs.yaml:
        stages.interp_on_track:
          _target_: qf_interp_grid_on_track.run
          _partial_: true
          track_path: ${..filter_and_merge.output_path}
          grid_path: data/method_outputs/${..method}.nc
          grid_var: ???
          output_path: data/method_outputs/${..method}_on_track.nc
          _skip_val: false
    outs:
    - path: data/method_outputs/duacs_on_track.nc
      hash: md5
      md5: 55a157bf35618a513e3fd35112218d48
      size: 1587360
  interp_on_track@dymost:
    cmd: qf_alongtrack_lambdax_from_map -cd . -cn stage_configs 'to_run=[interp_on_track]'
      'stages.interp_on_track.grid_var=ssh' 'stages.method=dymost'
    deps:
    - path: data/method_outputs/dymost.nc
      hash: md5
      md5: 1f6fc60bba2ef471ff845b4cdcc18f6a
      size: 2354338
    - path: data/prepared/c2.nc
      hash: md5
      md5: fb8bf253e87be431b298b136dde80d99
      size: 1397837
    params:
      datachallenge.toml:
        pipelines.diagnostic.qf_alongtrack_lambdax_from_map: 0.0.1
      stage_configs.yaml:
        stages.interp_on_track:
          _target_: qf_interp_grid_on_track.run
          _partial_: true
          track_path: ${..filter_and_merge.output_path}
          grid_path: data/method_outputs/${..method}.nc
          grid_var: ???
          output_path: data/method_outputs/${..method}_on_track.nc
          _skip_val: false
    outs:
    - path: data/method_outputs/dymost_on_track.nc
      hash: md5
      md5: 8873caf8d50b515f4fdd0462583d880e
      size: 1589740
  compute_lambdax@4dvarnet:
    cmd: qf_alongtrack_lambdax_from_map -cd . -cn stage_configs 'to_run=[lambdax]'
      'stages.interp_on_track.grid_var=rec_ssh' 'stages.method=4dvarnet'
    deps:
    - path: data/method_outputs/4dvarnet_on_track.nc
      hash: md5
      md5: a86f49eeb091b177ec0e48aa801c21a2
      size: 1587241
    - path: data/prepared/c2.nc
      hash: md5
      md5: fb8bf253e87be431b298b136dde80d99
      size: 1397837
    params:
      datachallenge.toml:
        pipelines.diagnostic.qf_alongtrack_lambdax_from_map: 0.0.1
      stage_configs.yaml:
        stages.lambdax:
          _target_: alongtrack_lambdax.main_api
          _partial_: true
          study_path: ${..interp_on_track.output_path}
          study_var: ${..interp_on_track.grid_var}
          ref_path: ${..filter_and_merge.output_path}
          ref_var: ssh
          delta_t: 0.9434
          velocity: 6.77
          length_scale: 850.0
          segment_overlapping: 0.25
          output_lambdax_path: data/metrics/lambdax_${..method}.json
          output_psd_path: data/method_outputs/psd_${..method}.json
    outs:
    - path: data/method_outputs/psd_4dvarnet.json
      hash: md5
      md5: 77602038e33fb0238ae69d318c1aa4d6
      size: 6734
    - path: data/metrics/lambdax_4dvarnet.json
      hash: md5
      md5: 6382516d9bb5646b200a3c32f9fc9a5e
      size: 31
  compute_lambdax@miost:
    cmd: qf_alongtrack_lambdax_from_map -cd . -cn stage_configs 'to_run=[lambdax]'
      'stages.interp_on_track.grid_var=ssh' 'stages.method=miost'
    deps:
    - path: data/method_outputs/miost_on_track.nc
      hash: md5
      md5: f5e9d3d586f044def64eff61c6e92198
      size: 1587360
    - path: data/prepared/c2.nc
      hash: md5
      md5: fb8bf253e87be431b298b136dde80d99
      size: 1397837
    params:
      datachallenge.toml:
        pipelines.diagnostic.qf_alongtrack_lambdax_from_map: 0.0.1
      stage_configs.yaml:
        stages.lambdax:
          _target_: alongtrack_lambdax.main_api
          _partial_: true
          study_path: ${..interp_on_track.output_path}
          study_var: ${..interp_on_track.grid_var}
          ref_path: ${..filter_and_merge.output_path}
          ref_var: ssh
          delta_t: 0.9434
          velocity: 6.77
          length_scale: 850.0
          segment_overlapping: 0.25
          output_lambdax_path: data/metrics/lambdax_${..method}.json
          output_psd_path: data/method_outputs/psd_${..method}.json
    outs:
    - path: data/method_outputs/psd_miost.json
      hash: md5
      md5: a171e49c0077fffe5e2e070487c2269d
      size: 6731
    - path: data/metrics/lambdax_miost.json
      hash: md5
      md5: 913c8a9aa05ae4cb5ed6556e5c21a59d
      size: 31
  compute_lambdax@bfn:
    cmd: qf_alongtrack_lambdax_from_map -cd . -cn stage_configs 'to_run=[lambdax]'
      'stages.interp_on_track.grid_var=ssh' 'stages.method=bfn'
    deps:
    - path: data/method_outputs/bfn_on_track.nc
      hash: md5
      md5: 3d31f6fed2f9786b7f69d0a8784abaec
      size: 1587360
    - path: data/prepared/c2.nc
      hash: md5
      md5: fb8bf253e87be431b298b136dde80d99
      size: 1397837
    params:
      datachallenge.toml:
        pipelines.diagnostic.qf_alongtrack_lambdax_from_map: 0.0.1
      stage_configs.yaml:
        stages.lambdax:
          _target_: alongtrack_lambdax.main_api
          _partial_: true
          study_path: ${..interp_on_track.output_path}
          study_var: ${..interp_on_track.grid_var}
          ref_path: ${..filter_and_merge.output_path}
          ref_var: ssh
          delta_t: 0.9434
          velocity: 6.77
          length_scale: 850.0
          segment_overlapping: 0.25
          output_lambdax_path: data/metrics/lambdax_${..method}.json
          output_psd_path: data/method_outputs/psd_${..method}.json
    outs:
    - path: data/method_outputs/psd_bfn.json
      hash: md5
      md5: f0edff33a1cf58cd87b23b809ec80ebf
      size: 6739
    - path: data/metrics/lambdax_bfn.json
      hash: md5
      md5: 913c8a9aa05ae4cb5ed6556e5c21a59d
      size: 31
  compute_lambdax@duacs:
    cmd: qf_alongtrack_lambdax_from_map -cd . -cn stage_configs 'to_run=[lambdax]'
      'stages.interp_on_track.grid_var=ssh' 'stages.method=duacs'
    deps:
    - path: data/method_outputs/duacs_on_track.nc
      hash: md5
      md5: 55a157bf35618a513e3fd35112218d48
      size: 1587360
    - path: data/prepared/c2.nc
      hash: md5
      md5: fb8bf253e87be431b298b136dde80d99
      size: 1397837
    params:
      datachallenge.toml:
        pipelines.diagnostic.qf_alongtrack_lambdax_from_map: 0.0.1
      stage_configs.yaml:
        stages.lambdax:
          _target_: alongtrack_lambdax.main_api
          _partial_: true
          study_path: ${..interp_on_track.output_path}
          study_var: ${..interp_on_track.grid_var}
          ref_path: ${..filter_and_merge.output_path}
          ref_var: ssh
          delta_t: 0.9434
          velocity: 6.77
          length_scale: 850.0
          segment_overlapping: 0.25
          output_lambdax_path: data/metrics/lambdax_${..method}.json
          output_psd_path: data/method_outputs/psd_${..method}.json
    outs:
    - path: data/method_outputs/psd_duacs.json
      hash: md5
      md5: aedb502a10d8d64cfb45de5f43eedfcf
      size: 6750
    - path: data/metrics/lambdax_duacs.json
      hash: md5
      md5: 5cd0e04d4a720126dea099122cbaada6
      size: 30
  compute_lambdax@dymost:
    cmd: qf_alongtrack_lambdax_from_map -cd . -cn stage_configs 'to_run=[lambdax]'
      'stages.interp_on_track.grid_var=ssh' 'stages.method=dymost'
    deps:
    - path: data/method_outputs/dymost_on_track.nc
      hash: md5
      md5: 8873caf8d50b515f4fdd0462583d880e
      size: 1589740
    - path: data/prepared/c2.nc
      hash: md5
      md5: fb8bf253e87be431b298b136dde80d99
      size: 1397837
    params:
      datachallenge.toml:
        pipelines.diagnostic.qf_alongtrack_lambdax_from_map: 0.0.1
      stage_configs.yaml:
        stages.lambdax:
          _target_: alongtrack_lambdax.main_api
          _partial_: true
          study_path: ${..interp_on_track.output_path}
          study_var: ${..interp_on_track.grid_var}
          ref_path: ${..filter_and_merge.output_path}
          ref_var: ssh
          delta_t: 0.9434
          velocity: 6.77
          length_scale: 850.0
          segment_overlapping: 0.25
          output_lambdax_path: data/metrics/lambdax_${..method}.json
          output_psd_path: data/method_outputs/psd_${..method}.json
    outs:
    - path: data/method_outputs/psd_dymost.json
      hash: md5
      md5: dc8eceb9f6c769931779444a8ae52c5d
      size: 6757
    - path: data/metrics/lambdax_dymost.json
      hash: md5
      md5: 913c8a9aa05ae4cb5ed6556e5c21a59d
      size: 31
  method_output@convlstm_ssh_sst:
    cmd: wget 
      https://s3.eu-west-2.wasabisys.com/oceanbench-data-registry/dvc/e6/a27e944de675bcf0cd0c67031f9d3f
      -nc -O 'data/method_outputs/convlstm_ssh_sst.nc'
    outs:
    - path: data/method_outputs/convlstm_ssh_sst.nc
      hash: md5
      md5: e6a27e944de675bcf0cd0c67031f9d3f
      size: 23372856
  interp_on_track@convlstm_ssh_sst:
    cmd: qf_alongtrack_lambdax_from_map -cd . -cn stage_configs 'to_run=[interp_on_track]'
      'stages.interp_on_track.grid_var=ssh' 'stages.method=convlstm_ssh_sst'
    deps:
    - path: data/method_outputs/convlstm_ssh_sst.nc
      hash: md5
      md5: e6a27e944de675bcf0cd0c67031f9d3f
      size: 23372856
    - path: data/prepared/c2.nc
      hash: md5
      md5: fb8bf253e87be431b298b136dde80d99
      size: 1397837
    params:
      datachallenge.toml:
        pipelines.diagnostic.qf_alongtrack_lambdax_from_map: 0.0.1
      stage_configs.yaml:
        stages.interp_on_track:
          _target_: qf_interp_grid_on_track.run
          _partial_: true
          track_path: ${..filter_and_merge.output_path}
          grid_path: data/method_outputs/${..method}.nc
          grid_var: ???
          output_path: data/method_outputs/${..method}_on_track.nc
          _skip_val: false
    outs:
    - path: data/method_outputs/convlstm_ssh_sst_on_track.nc
      hash: md5
      md5: e41a13173582607176fdc02e9b8dc96b
      size: 1587360
  compute_lambdax@convlstm_ssh_sst:
    cmd: qf_alongtrack_lambdax_from_map -cd . -cn stage_configs 'to_run=[lambdax]'
      'stages.interp_on_track.grid_var=ssh' 'stages.method=convlstm_ssh_sst'
    deps:
    - path: data/method_outputs/convlstm_ssh_sst_on_track.nc
      hash: md5
      md5: e41a13173582607176fdc02e9b8dc96b
      size: 1587360
    - path: data/prepared/c2.nc
      hash: md5
      md5: fb8bf253e87be431b298b136dde80d99
      size: 1397837
    params:
      datachallenge.toml:
        pipelines.diagnostic.qf_alongtrack_lambdax_from_map: 0.0.1
      stage_configs.yaml:
        stages.lambdax:
          _target_: alongtrack_lambdax.main_api
          _partial_: true
          study_path: ${..interp_on_track.output_path}
          study_var: ${..interp_on_track.grid_var}
          ref_path: ${..filter_and_merge.output_path}
          ref_var: ssh
          delta_t: 0.9434
          velocity: 6.77
          length_scale: 850.0
          segment_overlapping: 0.25
          output_lambdax_path: data/metrics/lambdax_${..method}.json
          output_psd_path: data/method_outputs/psd_${..method}.json
    outs:
    - path: data/method_outputs/psd_convlstm_ssh_sst.json
      hash: md5
      md5: cdf90e1b1fd99aa74de9134eeebf319d
      size: 6745
    - path: data/metrics/lambdax_convlstm_ssh_sst.json
      hash: md5
      md5: 26b15a736acc018e1741fe6390921ba0
      size: 31
